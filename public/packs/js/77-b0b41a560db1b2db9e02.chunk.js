(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{2055:function(e,t,n){var r=n(65),a=n(2404);"string"===typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var o={insert:"head",singleton:!1};r(a,o);e.exports=a.locals||{}},2403:function(e,t,n){"use strict";n(2055)},2404:function(e,t,n){(t=n(66)(!0)).push([e.i,"[data-v-33809b8d] .wrapper[data-type=checkbox] .formulate-input-wrapper{display:flex;align-items:center;line-height:1rem}[data-v-33809b8d] .wrapper[data-type=checkbox] .formulate-input-wrapper label{margin-left:.2rem}@media(prefers-color-scheme: dark){[data-v-33809b8d] .wrapper .formulate-input-element--date input,[data-v-33809b8d] .wrapper .formulate-input-element--checkbox input{color-scheme:dark}}[data-v-33809b8d] .wrapper[data-type=textarea] .formulate-input-element--textarea textarea{min-height:8rem}[data-v-33809b8d] .pre-chat-header-message .link{color:#1f93ff;text-decoration:underline}","",{version:3,sources:["/home/leonardo/chatwoot/app/javascript/widget/components/PreChat/Form.vue","/home/leonardo/chatwoot/app/javascript/widget/assets/scss/_variables.scss"],names:[],mappings:"AAII,wEACE,YAAA,CACA,kBAAA,CACA,gBCYS,CDVT,8EACE,iBAAA,CAIN,mCAIM,oIACE,iBAAA,CAAA,CAOJ,2FACE,eAAA,CAKJ,iDACE,aCOO,CDNP,yBAAA",file:"Form.vue",sourcesContent:["\n@import '~widget/assets/scss/variables.scss';\n::v-deep {\n  .wrapper[data-type='checkbox'] {\n    .formulate-input-wrapper {\n      display: flex;\n      align-items: center;\n      line-height: $space-normal;\n\n      label {\n        margin-left: 0.2rem;\n      }\n    }\n  }\n  @media (prefers-color-scheme: dark) {\n    .wrapper {\n      .formulate-input-element--date,\n      .formulate-input-element--checkbox {\n        input {\n          color-scheme: dark;\n        }\n      }\n    }\n  }\n  .wrapper[data-type='textarea'] {\n    .formulate-input-element--textarea {\n      textarea {\n        min-height: 8rem;\n      }\n    }\n  }\n  .pre-chat-header-message {\n    .link {\n      color: $color-woot;\n      text-decoration: underline;\n    }\n  }\n}\n","// Font sizes\n$font-size-micro: 0.5rem;\n$font-size-mini: 0.625rem;\n$font-size-small: 0.75rem;\n$font-size-default: 0.875rem;\n$font-size-medium: 1rem;\n$font-size-large: 1.25rem;\n$font-size-big: 1.5rem;\n$font-size-bigger: 2rem;\n$font-size-mega: 2.5rem;\n$font-size-giga: 3.5rem;\n\n// spaces\n$zero: 0;\n$space-micro: 0.125rem;\n$space-smaller: 0.25rem;\n$space-small: 0.5rem;\n$space-one: 0.625rem;\n$space-slab: 0.75rem;\n$space-normal: 1rem;\n$space-two: 1.25rem;\n$space-medium: 1.5rem;\n$space-large: 2rem;\n$space-larger: 3rem;\n$space-big: 4rem;\n$space-jumbo: 5rem;\n$space-mega: 6.25rem;\n\n$border-radius-small: 0.1875rem;\n$border-radius-normal: 0.3125rem;\n\n// font-weight\n$font-weight-feather: 100;\n$font-weight-light: 300;\n$font-weight-normal: 400;\n$font-weight-medium: 500;\n$font-weight-bold: 600;\n$font-weight-black: 700;\n\n// Colors\n$color-woot: #1f93ff;\n$color-primary: $color-woot;\n$color-gray: #6e6f73;\n$color-light-gray: #999a9b;\n$color-border: #e0e6ed;\n$color-border-transparent: rgba(224, 230, 237, 0.5);\n$color-border-light: #f0f4f5;\n$color-border-dark: #cad0d4;\n$color-background: #f4f6fb;\n$color-background-light: #fafafa;\n$color-white: #fff;\n$color-body: #3c4858;\n$color-heading: #1f2d3d;\n$color-error: #ff382d;\n$color-success: #44ce4b;\n\n// Color-palettes\n\n$color-primary-light: #c7e3ff;\n$color-primary-dark: darken($color-woot, 20%);\n\n// Snackbar default\n$woot-snackbar-bg: #323232;\n$woot-snackbar-button: #ffeb3b;\n\n$swift-ease-out-duration: 0.4s !default;\n$swift-ease-out-timing-function: cubic-bezier(0.25, 0.8, 0.25, 1) !default;\n$swift-ease-out: all $swift-ease-out-duration $swift-ease-out-timing-function !default;\n\n$border-radius: 0.1875px;\n$line-height: 1;\n$footer-height: 11.2rem;\n$header-expanded-height: $space-medium * 10;\n\n$font-family: 'Inter',\n  -apple-system,\n  system-ui,\n  BlinkMacSystemFont,\n  'Segoe UI',\n  Roboto,\n  'Helvetica Neue',\n  Tahoma,\n  Arial,\n  sans-serif;\n\n// Break points\n$break-point-medium: 667px;\n"]}]),e.exports=t},2488:function(e,t,n){"use strict";n.r(t);n(21),n(44),n(83),n(23),n(41),n(142),n(14),n(9),n(20),n(24),n(77),n(93),n(10),n(29),n(30);var r=n(924),a=n(200),o=n(38),s=n(278),i=n(101),l=n(218),c=n(897),u=n(738),m=n(319),p=n(368);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b={components:{CustomButton:r.a,Spinner:a.a},mixins:[u.a,p.a],props:{options:{type:Object,default:function(){}}},setup:function(){return{formatMessage:Object(c.a)().formatMessage,getThemeClass:Object(m.a)().getThemeClass}},data:function(){return{locale:this.$root.$i18n.locale,hasErrorInPhoneInput:!1,message:"",formValues:{},labels:{emailAddress:"EMAIL_ADDRESS",fullName:"FULL_NAME",phoneNumber:"PHONE_NUMBER"}}},computed:h(h({},Object(o.mapGetters)({widgetColor:"appConfig/getWidgetColor",isCreating:"conversation/getIsCreating",activeCampaign:"campaign/getActiveCampaign",currentUser:"contacts/getCurrentUser"})),{},{textColor:function(){return Object(s.f)(this.widgetColor)},hasActiveCampaign:function(){return!Object(i.d)(this.activeCampaign)},shouldShowHeaderMessage:function(){return this.hasActiveCampaign||this.preChatFormEnabled},headerMessage:function(){return this.preChatFormEnabled?this.options.preChatMessage:this.hasActiveCampaign?this.$t("PRE_CHAT_FORM.CAMPAIGN_HEADER"):""},preChatFields:function(){return this.preChatFormEnabled?this.options.preChatFields:[]},filteredPreChatFields:function(){var e=this.currentUser.has_email,t=this.currentUser.has_phone_number,n=!!(!!this.currentUser.identifier||e||t);return this.preChatFields.filter((function(r){return(!e||"emailAddress"!==r.name)&&((!t||"phoneNumber"!==r.name)&&(!n||"fullName"!==r.name))}))},enabledPreChatFields:function(){var e=this;return this.filteredPreChatFields.filter((function(e){return e.enabled})).map((function(t){return h(h({},t),{},{type:"phoneNumber"===t.name?"phoneInput":e.findFieldType(t.type)})}))},conversationCustomAttributes:function(){var e=this,t={};return this.enabledPreChatFields.forEach((function(n){"conversation_attribute"===n.field_type&&(t=h(h({},t),{},f({},n.name,e.getValue(n))))})),t},contactCustomAttributes:function(){var e=this,t={};return this.enabledPreChatFields.forEach((function(n){"contact_attribute"===n.field_type&&(t=h(h({},t),{},f({},n.name,e.getValue(n))))})),t},inputStyles:function(){return"mt-1 border rounded w-full py-2 px-3 text-slate-700 outline-none"},isInputDarkOrLightMode:function(){return"".concat(this.getThemeClass("bg-white","dark:bg-slate-600")," ").concat(this.getThemeClass("text-slate-700","dark:text-slate-50"))},inputBorderColor:function(){return"".concat(this.getThemeClass("border-black-200","dark:border-black-500"))}}),methods:{labelClass:function(e){var t=e.hasErrors;return"text-xs font-medium ".concat(t?this.getThemeClass("text-red-400","dark:text-red-400"):this.getThemeClass("text-black-800","dark:text-slate-50"))},inputClass:function(e){var t=e.hasErrors,n=e.classification,r=e.type;return"box"===n&&"checkbox"===r?"":("phoneInput"===r&&(this.hasErrorInPhoneInput=t),t?"".concat(this.inputStyles," border-red-200 hover:border-red-300 focus:border-red-300 ").concat(this.isInputDarkOrLightMode):"".concat(this.inputStyles," hover:border-black-300 focus:border-black-300 ").concat(this.isInputDarkOrLightMode," ").concat(this.inputBorderColor))},isContactFieldRequired:function(e){return this.preChatFields.find((function(t){return t.name===e})).required},getLabel:function(e){return e.label},getPlaceHolder:function(e){return e.placeholder},getValue:function(e){var t=e.name;return"select"===e.type?this.enabledPreChatFields.find((function(e){return e.name===t})).values[this.formValues[t]]:this.formValues[t]||null},getValidation:function(e){var t=e.type,n=e.name,r=e.field_type,a=e.regex_pattern,o=a?Object(l.a)(a):null,s={emailAddress:"email",phoneNumber:["startsWithPlus","isValidPhoneNumber"],url:"url",date:"date",text:null,select:null,number:null,checkbox:!1,contact_attribute:o?[["matches",o]]:null,conversation_attribute:o?[["matches",o]]:null},i=Object.keys(s),c=this.isContactFieldRequired(n)?["bail","required"]:["bail","optional"];if(i.includes(n)||i.includes(t)||i.includes(r)){var u=s[t]||s[n]||s[r];return u?c.concat(u):c}return[]},findFieldType:function(e){return"link"===e?"url":"list"===e?"select":e},getOptions:function(e){if("select"===e.type){var t={};return e.values.forEach((function(e,n){t=h(h({},t),{},f({},n,e))})),t}return null},onSubmit:function(){var e=this.formValues,t=e.emailAddress,n=e.fullName,r=e.phoneNumber,a=e.message;this.$emit("submit",{fullName:n,phoneNumber:r,emailAddress:t,message:a,activeCampaignId:this.activeCampaign.id,conversationCustomAttributes:this.conversationCustomAttributes,contactCustomAttributes:this.contactCustomAttributes})}}},g=(n(2403),n(8)),C=Object(g.a)(b,(function(){var e=this,t=e._self._c;return t("FormulateForm",{staticClass:"flex flex-col flex-1 p-6 overflow-y-auto",on:{submit:e.onSubmit},model:{value:e.formValues,callback:function(t){e.formValues=t},expression:"formValues"}},[e.shouldShowHeaderMessage?t("div",{directives:[{name:"dompurify-html",rawName:"v-dompurify-html",value:e.formatMessage(e.headerMessage,!1),expression:"formatMessage(headerMessage, false)"}],staticClass:"mb-4 text-sm leading-5 pre-chat-header-message",class:e.getThemeClass("text-black-800","dark:text-slate-50")}):e._e(),e._v(" "),e._l(e.enabledPreChatFields,(function(n){return t("FormulateInput",{key:n.name,attrs:{name:n.name,type:n.type,label:e.getLabel(n),placeholder:e.getPlaceHolder(n),validation:e.getValidation(n),options:e.getOptions(n),"label-class":t=>e.labelClass(t),"input-class":t=>e.inputClass(t),"validation-messages":{startsWithPlus:e.$t("PRE_CHAT_FORM.FIELDS.PHONE_NUMBER.DIAL_CODE_VALID_ERROR"),isValidPhoneNumber:e.$t("PRE_CHAT_FORM.FIELDS.PHONE_NUMBER.VALID_ERROR"),email:e.$t("PRE_CHAT_FORM.FIELDS.EMAIL_ADDRESS.VALID_ERROR"),required:e.$t("PRE_CHAT_FORM.REQUIRED"),matches:n.regex_cue?n.regex_cue:e.$t("PRE_CHAT_FORM.REGEX_ERROR")},"has-error-in-phone-input":e.hasErrorInPhoneInput}})})),e._v(" "),e.hasActiveCampaign?e._e():t("FormulateInput",{attrs:{name:"message",type:"textarea","label-class":t=>e.labelClass(t),"input-class":t=>e.inputClass(t),label:e.$t("PRE_CHAT_FORM.FIELDS.MESSAGE.LABEL"),placeholder:e.$t("PRE_CHAT_FORM.FIELDS.MESSAGE.PLACEHOLDER"),validation:"required","validation-messages":{required:e.$t("PRE_CHAT_FORM.FIELDS.MESSAGE.ERROR")}}}),e._v(" "),t("CustomButton",{staticClass:"mt-2 mb-5 font-medium",attrs:{block:"","bg-color":e.widgetColor,"text-color":e.textColor,disabled:e.isCreating}},[e.isCreating?t("Spinner",{staticClass:"p-0"}):e._e(),e._v("\n    "+e._s(e.$t("START_CONVERSATION"))+"\n  ")],1)],2)}),[],!1,null,"33809b8d",null).exports,v=n(325),$={components:{PreChatForm:C},mixins:[p.a,u.a],mounted:function(){var e=this;this.$emitter.on(v.c,(function(){e.replaceRoute("messages")}))},methods:{onSubmit:function(e){var t=e.fullName,n=e.emailAddress,r=e.message,a=e.activeCampaignId,o=e.phoneNumber,s=e.contactCustomAttributes,l=e.conversationCustomAttributes;a?(this.$emitter.emit("execute-campaign",{campaignId:a,customAttributes:l}),this.$store.dispatch("contacts/update",{user:{email:n,name:t,phone_number:o}})):this.$store.dispatch("conversation/createConversation",{fullName:t,emailAddress:n,message:r,phoneNumber:o,customAttributes:l}),Object(i.d)(s)||this.$store.dispatch("contacts/setCustomAttributes",s)}}},A=Object(g.a)($,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"flex flex-1 overflow-auto"},[t("PreChatForm",{attrs:{options:e.preChatFormOptions},on:{submit:e.onSubmit}})],1)}),[],!1,null,null,null);t.default=A.exports},897:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));n(59),n(54),n(75),n(364),n(143),n(14),n(9),n(17),n(20),n(205),n(23);var r=n(899),a=n.n(r),o=(n(382),/mention:\/\/(user|team)\/(\d+)\/(.+)/gm);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(e){e.children.forEach((function(e){"image"===e.type&&function(e){var t=e.attrGet("src");if(t){var n=new URL(t).searchParams.get("cw_image_height");n&&e.attrSet("style","height: ".concat(n,";"))}}(e)}))},c=n(763)({html:!1,xhtmlOut:!0,breaks:!0,langPrefix:"language-",linkify:!0,typographer:!0,quotes:"\u201c\u201d\u2018\u2019",maxNesting:20}).use((function(e){e.renderer.rules.mention=function(e,t){return'<span class="prosemirror-mention-node">'.concat(e[t].content,"</span>")},e.inline.ruler.before("link","mention",(function(e,t){var n,r,a,s,i,l,c="",u=e.posMax;return 91===e.src.charCodeAt(e.pos)&&(a=e.pos+1,!((r=e.md.helpers.parseLinkLabel(e,e.pos,!0))<0)&&(n=e.src.slice(a,r),(s=r+1)<u&&40===e.src.charCodeAt(s)&&(s+=1,(i=e.md.helpers.parseLinkDestination(e.src,s,e.posMax)).ok&&(c=e.md.normalizeLink(i.str),e.md.validateLink(c)?s=i.pos:c=""),s+=1),!!c.match(new RegExp(o))&&(t||(e.pos=a,e.posMax=r,(l=e.push("mention","")).href=c,l.content=n),e.pos=s,e.posMax=u,!0)))}))})).use((function(e){e.core.ruler.after("inline","add-image-height",(function(e){e.tokens.forEach((function(e){"inline"===e.type&&l(e)}))}))})).use(a.a,{attrs:{class:"link",rel:"noreferrer noopener nofollow",target:"_blank"}}),u=/(^|[^@\w])@(\w{1,15})\b/g,m=/(^|\s)#(\w+)/g,p=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s(this,e),this.message=t||"",this.isAPrivateNote=r,this.isATweet=n}var t,n,r;return t=e,(n=[{key:"formatMessage",value:function(){var e=this.message;return this.isATweet&&!this.isAPrivateNote&&(e=(e=e.replace(u,"$1[@$2](http://twitter.com/$2)")).replace(m,"$1[#$2](https://twitter.com/hashtag/$2)")),c.render(e)}},{key:"formattedMessage",get:function(){return this.formatMessage()}},{key:"plainText",get:function(){return(new DOMParser).parseFromString(this.formattedMessage,"text/html").body.textContent||""}}])&&i(t.prototype,n),r&&i(t,r),e}(),d=p,h=function(){var e=function(e,t){return new d(e,t).plainText};return{formatMessage:function(e,t,n){return new d(e,t,n).formattedMessage},getPlainText:e,truncateMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.length<100?e:"".concat(e.slice(0,97),"...")},highlightContent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=e(t),o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return a.replace(new RegExp("(".concat(o,")"),"ig"),'<span class="'.concat(r,'">$1</span>'))}}}},924:function(e,t,n){"use strict";n(24);var r={props:{block:{type:Boolean,default:!1},type:{type:String,default:"blue"},bgColor:{type:String,default:""},textColor:{type:String,default:""},disabled:{type:Boolean,default:!1}},computed:{buttonClassName:function(){var e="text-white py-3 px-4 rounded shadow-sm leading-4";return"clear"===this.type&&(e="flex mx-auto mt-4 text-xs leading-3 w-auto text-black-600"),"blue"!==this.type||Object.keys(this.buttonStyles).length||(e="".concat(e," bg-woot-500 hover:bg-woot-700")),this.block&&(e="".concat(e," w-full")),e},buttonStyles:function(){var e={};return this.bgColor&&(e.backgroundColor=this.bgColor),this.textColor&&(e.color=this.textColor),e}},methods:{onClick:function(e){this.$emit("click",e)}}},a=n(8),o=Object(a.a)(r,(function(){var e=this;return(0,e._self._c)("button",{class:e.buttonClassName,style:e.buttonStyles,attrs:{disabled:e.disabled},on:{click:e.onClick}},[e._t("default")],2)}),[],!1,null,null,null);t.a=o.exports}}]);
//# sourceMappingURL=77-b0b41a560db1b2db9e02.chunk.js.map